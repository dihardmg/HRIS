-- Update leave_request table to properly handle approval and rejection notes
-- Add approval_notes column for approved requests
ALTER TABLE leave_request
ADD COLUMN approval_notes TEXT;

-- Move existing approval data from rejection_reason to approval_notes for approved requests
UPDATE leave_request
SET approval_notes = rejection_reason
WHERE status = 'APPROVED' AND rejection_reason IS NOT NULL;

-- Clear rejection_reason for approved requests (it should only be for rejections)
UPDATE leave_request
SET rejection_reason = NULL
WHERE status = 'APPROVED';

-- Add comments for clarity
COMMENT ON COLUMN leave_request.approval_notes IS 'Notes added by supervisor when approving a leave request';
COMMENT ON COLUMN leave_request.rejection_reason IS 'Reason provided by supervisor when rejecting a leave request';